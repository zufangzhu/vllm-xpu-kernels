#include "chunk_prefill.hpp"

using namespace cute;

// clang-format off
// macros to be filled in CMake
#define IMPL_T ${IMPL_T}
#define IMPL_KV_T ${IMPL_KV_T}
#define IMPL_POLICY ${IMPL_POLICY}
#cmakedefine01 IMPL_KISPAGED
#cmakedefine01 IMPL_KISCAUSAL
#cmakedefine01 IMPL_KISSINK
#cmakedefine01 IMPL_KISLOCAL
// clang-format on

#define INSTANTIATE_KERNEL()             \
  template void policy_dispatch_impl<    \
      IMPL_POLICY,                       \
      static_cast<bool>(IMPL_KISPAGED),  \
      static_cast<bool>(IMPL_KISCAUSAL), \
      static_cast<bool>(IMPL_KISLOCAL),  \
      static_cast<bool>(IMPL_KISSINK)>(  \
      sycl::queue & queue,               \
      CutlassQKType& cuQKType,           \
      const chunk_prefill_args_t& args);

INSTANTIATE_KERNEL()
