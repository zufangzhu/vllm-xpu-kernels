#include "paged_decode.hpp"

using namespace cute;

// =============================================================================
// CMake Template Variables
// =============================================================================
// These macros are populated by CMake during the configuration process
// to generate specific kernel instantiations for each policy combination.

// clang-format off
#define IMPL_POLICY ${IMPL_POLICY}
#cmakedefine01 IMPL_KISCAUSAL
#cmakedefine01 IMPL_KISLOCAL
#cmakedefine01 IMPL_KISSINK
// clang-format on

// =============================================================================
// Explicit Template Instantiation
// =============================================================================
// Instantiate the decode_policy_dispatch_impl function template with the
// specific policy and boolean flag combinations provided by CMake. This
// produces one compiled kernel per source file.

#define INSTANTIATE_KERNEL()                 \
  template void decode_policy_dispatch_impl< \
      IMPL_POLICY,                           \
      static_cast<bool>(IMPL_KISCAUSAL),     \
      static_cast<bool>(IMPL_KISLOCAL),      \
      static_cast<bool>(IMPL_KISSINK)>(      \
      sycl::queue & queue,                   \
      CutlassDType cuType,                    \
      const paged_decode_args_t& args);

INSTANTIATE_KERNEL()
